---
title: R语言基础笔记
abbrlink: r-basic
katex: false
root: ../../
categories:
  - 学习
  - ⌨️软件编程
  - R
hidden:
published:
author: sion
output: html_document
date: 2023-04-24 22:41:10
update: 2023-04-24 22:41:10
tags:
  - 数据分析
  - 可视化
description: r语言学习笔记
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

{% note info %} 本文参考李东风老师的[R语言教程](https://www.math.pku.edu.cn/teachers/lidf/docs/Rbook/html/_Rbook/index.html)，并以Rmarkdown的格式写的，源文件（点击文章标题处的小铅笔可以转到Github的仓库地址）可以直接用Rstudio的Knit编译出来。 {% endnote %}

## 楔子

今天又又又一次开始学习R语言了，之前在学概率论时候学过一次、上C语言时候又试过一次，但最后总是烂尾。其实这归根到底还是没有使用好这技能，生物学上，关于进化论有一句经典的概括—**用进废退**，越用越进化，不用就退化，你看看长颈鹿🦒的长脖子，鼹鼠的瞎眼，便是极为明显的例子。对于人类来讲，技能的习得也是一样的道理，使用地少而不遗忘几乎是不可能的事。谁知道我心里这把无名的热情过去后，还会存留什么呢？（很可能就是这几篇文章而已）

这回重新学习，直接原因是为了画好毕业论文中的图表。

其实中午干饭时候，在掌阅里搜了本Origin2022的教程，看了下，觉着也不太复杂，下午就试着用origin（破解版）画了个三维图。因为软件里有大量现成的例子，绘图的确是挺简单的，但是若想画出来一个理想的图，就不得不需要调节大量的细节了，点来点去，极为繁琐。

克劳斯·O.威尔克在《数据可视化基础》一书中提到：**数据可视化要把自动化作为朋友**，形成一个线性的工作流。图表应当做为流的一部分自动生成，而且要尽量避免后期的再处理（比如用R画了个图，又导到AI里美化等等）。他强调：一旦在后期对图表进行了手动编辑，图片就不再可能再现，返工也极为麻烦，分叉的流不是个完美的工作流！

不巧的是，上面克佬所说的这些痛点在origin中比比皆是：手动导入数据，手动编辑各个部分细节，手动导出，手动...这个流简直跟亚马逊河的支流一般了。虽然此软件也图表模板的功能作为补充，但是自动化程度还是太低，一点也不**优雅**。另外吐槽一句：origin2022最新版的界面在2023年着实吓到我了，简直梦回win7，公司里的设计师都被裁员了吗？真是令人哭笑不得。

![origin 2022](https://pic.si-on.top/2023/04/20230425011753.png)


但再理性地想想，工具本身并不会控制人，人才是工具的主宰，本着**技多不压身**的终身学习者**人生信条**，这origin还是要掌握的。毕竟这种所见即所得的软件入门极快，再稍稍掌握些技巧就可以得心应手了。

另一类绘图工具，如R语言、Python，或者莫若说一些数据可视化的宏包如ggplot等，则是这阶段主要去学习掌握的内容。这类工具虽然入门麻烦点，但是一旦可以熟练掌握，一通百通，后益无穷啊！

掌握数据可视化的共性才是最终目的。还是克佬说得好，数据可视化是科学性与艺术性的组合。不仅需要掌握各种绘图的技巧，更是要培养美学鉴赏力，这样才能绘制出来美观的图表。其实从某些方面讲，数据可视化跟摄影后期处理很是相似，即能力的提升与鉴赏力的提高是并行的。

## R语言基本要点简述

### 数据结构

R语言数据结构包括**向量**，**矩阵**和**数据框**，**多维数组**， **列表**，**对象**等。数据中元素、行、列还可以用名字访问。

#### 向量

向量在数据可视化中很常用，坐标轴的刻度往往就需要一个合适的向量来控制。

使用`c()`来可以生成一个简单的向量，比如`21 22 23 1 5 9 7`可以这样生成

```{r}
rabbit1 <- c(21:23,1,5,9,7)
cat("rabbit1:",rabbit1,"\n")
```
```r
rabbit1: 21 22 23 1 5 9 7
```

使用`seq()`函数，可以来生成指定**增量**的向量。比如从400开始，每50个数取一个值，直到1200的向量`rabbit2`。也可以生成指定**间隔**的向量，比如从400到1200之间分成13份的向量\`rabbit3\`\`

```{r}
rabbit2=seq(400,1200, by=50)
cat("rabbit2:",rabbit2,"\n")

rabbit3=seq(400,1200, length.out=13)
cat("rabbit3:",rabbit3,"\n")
```

```r
rabbit2: 400 450 500 550 600 650 700 750 800 850 900 950 1000 1050 1100 1150 1200
rabbit3: 400 466.6667 533.3333 600 666.6667 733.3333 800 866.6667 933.3333 1000 1066.667 1133.333 1200
```


使用`rep()`函数，生成重复向量。比如一个长度为10的值全为6的变量`rabbit6`

```{r}
rabbit6 = rep(6,10)
cat("rabbit6:",rabbit6)
```

```r
rabbit6: 6 6 6 6 6 6 6 6 6 6
```

### 运算与函数

就平时用到的计算而言，就加减乘除、幂对三角函数而已：

```{r}
s1 = (2023+4+24-9)*36/51
s2 <- log10(101)
s3 = sin(pi/6)
s4 = 2023^2
s44 = sqrt(s4)
#R语言中的一些命令与linux很相似，比如cat
cat("s1=",s1,"‖","s2=",s2,"‖","s3=",s3,"‖","s4=",s4,"‖","s44=",s44)
```

```r
s1= 1441.412 ‖ s2= 2.004321 ‖ s3= 0.5 ‖ s4= 4092529 ‖ s44= 2023
```

一门语言最基本的就是函数了，R语言内置了许多数学函数，可以很方便的进行调用运算,比如标准正态分布$N(0,1)$的概率密度函数------`dnorm`。

> 考研复习的是数二，概率论已经忘干净了，这个函数大概是表示在平均值为0，标准差为1的正态分布下，一个给定值在这个分布函数内有多大概率出现，比如绝对值小于1.98的数在这个分布内有0.9438169的概率出现。

```{r}
1-dnorm(1.98)
```

```r
[1] 0.9438169
```


复合函数的调用还在用$F(u(x,y),v(x,y))$吗？已经OUT了，用管道运算符，可以更清晰的表现函数的流动，可以类比成复合函数求导中链式法则的一条链，上式的四条链可以写成：

-   `x |> u() |> F()`
-   `x |> v() |> F()`
-   `y |> u() |> F()`
-   `y |> v() |> F()`

这里就以2023年考研数二第十八题的符合函数做个示范 

$$
f(x,y)=x e^{\cos y}+\frac{x^2}{2}
$$ 

R语言自定义函数也非常简单,用`f <- \(x1,x2,x3x...)`来定义$f(x_1,x_2,x_3,\dots)$，那么上式可以这样定义，再顺手定义一个展示函数`show()`

```{r}
f <- \(x,y) x*(exp(1))^{cos(y)}+(x^2)/2
show <- \(x,y) cat("f(",x,",",y,")=",f(x,y),"\n")
# 简答计算一下x=2，y=90°时的值：
show(2,pi/2)
# 再求下题目中要求的函数的极值：
cat("极小值:")
show(-exp(1),2*pi)
```

```r
f( 2 , 1.570796 )= 4 
极小值:f( -2.718282 , 6.283185 )= -3.694528 
```

> 🎵 谷雨微冷的晚上，图书馆里，边听jazz，边码字学习，真是太惬意了。😊
